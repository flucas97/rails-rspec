require 'rails_helper'

RSpec.describe CustomersController, :customer_controller, type: :controller do
  let(:member) { create(:member )}

  context 'Actions' do
    it '#index' do
      get :index
      expect(response).to be_successful 
    end
    it '#create' do
      expect(member).to be_valid
    end
    it '#update' do
      member.update(password: '123')
      expect(response).to be_successful
    end

    it '#show' do 
      customer = create(:customer)
      sign_in member
      get :show, params: { id: customer.id }
      expect(response).to have_http_status(200)
    end
  end

  context 'Validations' do 
    
  end
end

#<ActionDispatch::TestResponse:0x000055f6aa7d63c8 @mon_owner=nil, @mon_count=0, @mon_mutex=#<Thread::Mutex:0x000055f6aa7d6328>, @header={\"X-Frame-Options\"=>\"SAMEORIGIN\", \"X-XSS-Protection\"=>\"1; mode=block\", \"X-Content-Type-Options\"=>\"nosniff\", \"X-Download-Options\"=>\"noopen\", \"X-Permitted-Cross-Domain-Policies\"=>\"none\", \"Referrer-Policy\"=>\"strict-origin-when-cross-origin\", \"Content-Type\"=>\"text/html; charset=utf-8\"}, @stream=#<ActionDispatch::Response::Buffer:0x000055f6aa7fa250 @response=#<ActionDispatch::TestResponse:0x000055f6aa7d63c8 ...>, @buf=[\"\"], @closed=false, @str_body=nil>, @status=200, @cv=#<MonitorMixin::ConditionVariable:0x000055f6aa7d62b0 @monitor=#<ActionDispatch::TestResponse:0x000055f6aa7d63c8 ...>, @cond=#<Thread::ConditionVariable:0x000055f6aa7d6288>>, @committed=true, @sending=false, @sent=true, @cache_control={}, @response_parser=#<Proc:0x000055f6aa7d60a8@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/actionpack-5.2.4.2/lib/action_dispatch/testing/request_encoder.rb:9 (lambda)>, @request=#<ActionController::TestRequest:0x000055f6aa7d6558 @env={\"rack.version\"=>[1, 3], \"rack.input\"=>#<StringIO:0x000055f6aa7d65f8>, \"rack.errors\"=>#<StringIO:0x000055f6a94705b8>, \"rack.multithread\"=>true, \"rack.multiprocess\"=>true, \"rack.run_once\"=>false, \"REQUEST_METHOD\"=>\"GET\", \"SERVER_NAME\"=>\"example.org\", \"SERVER_PORT\"=>\"80\", \"QUERY_STRING\"=>\"\", \"rack.url_scheme\"=>\"http\", \"HTTPS\"=>\"off\", \"SCRIPT_NAME\"=>\"\", \"HTTP_HOST\"=>\"test.host\", \"REMOTE_ADDR\"=>\"0.0.0.0\", \"HTTP_USER_AGENT\"=>\"Rails Testing\", \"action_dispatch.parameter_filter\"=>[:password], \"action_dispatch.redirect_filter\"=>[], \"action_dispatch.secret_token\"=>nil, \"action_dispatch.secret_key_base\"=>\"e673c7ff510417188d97b1f24e66e5619d160f4c236ce2f43cff22ffd07662687761747ec7963b7b807431e42fc649180c7be8f2db3af2d13d461a2d8ce94a02\", \"action_dispatch.show_exceptions\"=>false, \"action_dispatch.show_detailed_exceptions\"=>true, \"action_dispatch.logger\"=>#<ActiveSupport::Logger:0x000055f6a7e2e700 @level=0, @progname=nil, @default_formatter=#<Logger::Formatter:0x000055f6a7e2e610 @datetime_format=nil>, @formatter=#<ActiveSupport::Logger::SimpleFormatter:0x000055f6a7f54dc8 @datetime_format=nil, @thread_key=\"activesupport_tagged_logging_tags:47258934093540\">, @logdev=#<Logger::LogDevice:0x000055f6a7e2e598 @shift_period_suffix=nil, @shift_size=nil, @shift_age=nil, @filename=nil, @dev=#<File:/home/lucas.feijo/Desktop/DEV/Ruby/RSpec-App/app_rspec/log/test.log>, @mon_owner=nil, @mon_count=0, @mon_mutex=#<Thread::Mutex:0x000055f6a7e2e4f8>>, @local_levels=#<Concurrent::Map:0x000055f6a7e2e408 entries=0 default_proc=nil>>, \"action_dispatch.backtrace_cleaner\"=>#<Rails::BacktraceCleaner:0x000055f6a94713f0 @filters=[#<Proc:0x000055f6a9471260@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/railties-5.2.4.2/lib/rails/backtrace_cleaner.rb:16>, #<Proc:0x000055f6a9471238@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/railties-5.2.4.2/lib/rails/backtrace_cleaner.rb:17>, #<Proc:0x000055f6a94711e8@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/railties-5.2.4.2/lib/rails/backtrace_cleaner.rb:18>, #<Proc:0x000055f6a9470db0@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/railties-5.2.4.2/lib/rails/backtrace_cleaner.rb:31>], @silencers=[#<Proc:0x000055f6a9470d88@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/railties-5.2.4.2/lib/rails/backtrace_cleaner.rb:21>], @root=\"/home/lucas.feijo/Desktop/DEV/Ruby/RSpec-App/app_rspec/\">, \"action_dispatch.key_generator\"=>#<ActiveSupport::CachingKeyGenerator:0x000055f6a81e2748 @key_generator=#<ActiveSupport::KeyGenerator:0x000055f6a81e2770 @secret=\"e673c7ff510417188d97b1f24e66e5619d160f4c236ce2f43cff22ffd07662687761747ec7963b7b807431e42fc649180c7be8f2db3af2d13d461a2d8ce94a02\", @iterations=1000>, @cache_keys=#<Concurrent::Map:0x000055f6a81e26d0 entries=2 default_proc=nil>>, \"action_dispatch.http_auth_salt\"=>\"http authentication\", \"action_dispatch.signed_cookie_salt\"=>\"signed cookie\", \"action_dispatch.encrypted_cookie_salt\"=>\"encrypted cookie\", \"action_dispatch.encrypted_signed_cookie_salt\"=>\"signed encrypted cookie\", \"action_dispatch.authenticated_encrypted_cookie_salt\"=>\"authenticated encrypted cookie\", \"action_dispatch.use_authenticated_cookie_encryption\"=>true, \"action_dispatch.encrypted_cookie_cipher\"=>nil, \"action_dispatch.signed_cookie_digest\"=>nil, \"action_dispatch.cookies_serializer\"=>:json, \"action_dispatch.cookies_digest\"=>nil, \"action_dispatch.cookies_rotations\"=>#<ActiveSupport::Messages::RotationConfiguration:0x000055f6a5366540 @signed=[], @encrypted=[]>, \"action_dispatch.content_security_policy\"=>nil, \"action_dispatch.content_security_policy_report_only\"=>false, \"action_dispatch.content_security_policy_nonce_generator\"=>nil, \"rack.session\"=>{\"warden.user.member.key\"=>[[29], \"$2a$04$3BkDAyKbOKpd1kyxYHKLDO\"]}, \"rack.session.options\"=>{:key=>\"rack.session\", :path=>\"/\", :domain=>nil, :expire_after=>nil, :secure=>false, :httponly=>true, :defer=>false, :renew=>false, :sidbits=>128, :cookie_only=>true, :secure_random=>SecureRandom}, \"action_controller.instance\"=>#<CustomersController:0x000055f6aa7ac5f0 @_action_has_layout=true, @_routes=nil, @_request=#<ActionController::TestRequest:0x000055f6aa7d6558 ...>, @_response=#<ActionDispatch::TestResponse:0x000055f6aa7d63c8 ...>, @_params=<ActionController::Parameters {\"id\"=>\"187\", \"controller\"=>\"customers\", \"action\"=>\"show\"} permitted: false>, @_url_options=nil, @_lookup_context=#<ActionView::LookupContext:0x000055f6aa7d6058 @details_key=#<Concurrent::Map:0x000055f6a943efb8 entries=0 default_proc=nil>, @cache=true, @prefixes=[\"customers\", \"application\"], @rendered_format=:html, @details={:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:raw, :erb, :html, :builder, :ruby, :coffee, :jbuilder]}, @view_paths=#<ActionView::PathSet:0x000055f6aa7d5f40 @paths=[#<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73ef50 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973ab40 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973ab18 keys=1 queries=0>, @path=\"/home/lucas.feijo/Desktop/DEV/Ruby/RSpec-App/app_rspec/app/views\">>, #<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73ef28 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973af50 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973af28 keys=1 queries=0>, @path=\"/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/rails_db-2.3.1/app/views\">>, #<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73ef00 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973b360 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973b338 keys=1 queries=0>, @path=\"/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/kaminari-core-1.2.0/app/views\">>, #<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73eed8 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973b770 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973b748 keys=1 queries=0>, @path=\"/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/devise-4.5.0/app/views\">>]>>, @_action_name=\"show\", @_response_body=[\"\"], @marked_for_same_origin_verification=true, @_config={}, @_db_runtime=0.20333299471531063, @_view_context_class=#<Class:0x000055f6a943c218>, @_view_renderer=#<ActionView::Renderer:0x000055f6aa8006a0 @lookup_context=#<ActionView::LookupContext:0x000055f6aa7d6058 @details_key=#<Concurrent::Map:0x000055f6a943efb8 entries=0 default_proc=nil>, @cache=true, @prefixes=[\"customers\", \"application\"], @rendered_format=:html, @details={:locale=>[:en], :formats=>[:html], :variants=>[], :handlers=>[:raw, :erb, :html, :builder, :ruby, :coffee, :jbuilder]}, @view_paths=#<ActionView::PathSet:0x000055f6aa7d5f40 @paths=[#<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73ef50 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973ab40 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973ab18 keys=1 queries=0>, @path=\"/home/lucas.feijo/Desktop/DEV/Ruby/RSpec-App/app_rspec/app/views\">>, #<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73ef28 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973af50 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973af28 keys=1 queries=0>, @path=\"/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/rails_db-2.3.1/app/views\">>, #<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73ef00 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973b360 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973b338 keys=1 queries=0>, @path=\"/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/kaminari-core-1.2.0/app/views\">>, #<RSpec::Rails::ViewRendering::EmptyTemplateResolver::ResolverDecorator:0x000055f6aa73eed8 @resolver=#<ActionView::OptimizedFileSystemResolver:0x000055f6a973b770 @pattern=\":prefix/:action{.:locale,}{.:formats,}{+:variants,}{.:handlers,}\", @cache=#<ActionView::Resolver::Cache:0x55f6a973b748 keys=1 queries=0>, @path=\"/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/devise-4.5.0/app/views\">>]>>>, @_view_runtime=0.7106620032573119, @customer=#<Customer id: 187, name: \"Alejandro Harris\", email: \"norberto.hauck@muller.info\", vip: nil, days_to_pay: nil, address: \"38056 Deja Skyway\", created_at: \"2020-04-23 22:22:44\", updated_at: \"2020-04-23 22:22:44\">>, \"warden\"=>Warden::Proxy:47258944673880 @config={:default_scope=>:member, :scope_defaults=>{}, :default_strategies=>{:member=>[:rememberable, :database_authenticatable]}, :intercept_401=>false, :failure_app=>#<Devise::Delegator:0x000055f6a921c500>}, \"HTTP_COOKIE\"=>\"\", \"PATH_INFO\"=>\"/customers/187\", \"action_dispatch.request.path_parameters\"=>{:id=>\"187\", :controller=>\"customers\", :action=>\"show\"}, \"action_dispatch.request.flash_hash\"=>#<ActionDispatch::Flash::FlashHash:0x000055f6aa7d5090 @discard=#<Set: {}>, @flashes={}, @now=nil>, \"action_dispatch.request.content_type\"=>nil, \"action_dispatch.request.request_parameters\"=>{}, \"rack.request.query_string\"=>\"\", \"rack.request.query_hash\"=>{}, \"action_dispatch.request.query_parameters\"=>{}, \"action_dispatch.request.parameters\"=>{\"id\"=>\"187\", \"controller\"=>\"customers\", \"action\"=>\"show\"}, \"action_dispatch.request.formats\"=>[#<Mime::Type:0x000055f6a5d34d38 @synonyms=[\"application/xhtml+xml\"], @symbol=:html, @string=\"text/html\", @hash=-1405469824663736605>]}, @filtered_parameters={\"id\"=>\"187\", \"controller\"=>\"customers\", \"action\"=>\"show\"}, @filtered_env=nil, @filtered_path=nil, @protocol=nil, @port=nil, @method=nil, @request_method=\"GET\", @remote_ip=nil, @original_fullpath=nil, @fullpath=\"/customers/187\", @ip=nil, @controller_class=CustomersController, @custom_param_parsers={:xml=>#<Proc:0x000055f6aa7d64b8@/home/lucas.feijo/.rvm/gems/ruby-2.4.5/gems/actionpack-5.2.4.2/lib/action_controller/test_case.rb:61 (lambda)>}, @headers=#<ActionDispatch::Http::Headers:0x000055f6a9333f88 @req=#<ActionController::TestRequest:0x000055f6aa7d6558 ...>>, @variant=[]>>"
